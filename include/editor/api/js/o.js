var pictureCore={type:"panel",g:function(a){return document.getElementById(a)},getEditorDoc:function(){return"panel"==this.type?parent:parent.parent},init:function(){$("#dataID").val(this.GetConf("dataID"));$("#dataType").val(this.GetConf("dataType"));$("#TempID").val(this.GetConf("TempID"))},showDemo:function(a,b,c,d,e,f,g){$("#userID").val(a);$("#NickName").val(b);$("#fileID").val(f);$("#filePathInfo").val(g);a=this.getEditorDoc();b=a.editor.Instance.Name+"___TempID";""==a.document.getElementById(b).value&&
(a.document.getElementById(b).value=c);$("#uploading").css("display","none");$("#picture").val("");$("#select").css("display","block");$("#confirm").css("display","block");c="height:180px;";180>e&&(c="height:"+e+"px;");$("#preview").html('<img src="'+g+'" style="'+c+'" onclick="pictureCore.setHtml();">')},setHtml:function(){var a=$("#filePathInfo").val(),b=$("#picalign").val(),c="",c="default"==b?'<img border="0" src="'+a+'">':'<img border="0" src="'+a+'" align="'+b+'">';$("#fileID").val("");$("#filePathInfo").val("");
this.cancel();this.getEditorDoc().editor.Instance.InsertHtml(c);"panel"!=this.type&&parent.Cancel()},cancel:function(){$("#uploading").css("display","none");$("#picture").val("");$("#picalign").val("default");$("#picsize").val("auto");$("#select").css("display","block");$("#confirm").css("display","none");$("#preview").html("\u6682\u65e0\u9884\u89c8");""!=$("#fileID").val()&&this.delfile();"panel"==this.type&&(this.setPanelClose(),parent.editor.Instance.Focus(),parent.editor.Instance.Events.FireEvent("OnSelectionChange"))},
setPanelClose:function(){parent.document.getElementById(parent.editor.Instance.Name+"___PanelStatus").value=0},addfile:function(){$("#uploading").css("display","block");$("#select").css("display","none");if(this.fileCheck()){var a=this.g("picture_upload_input");a.action="/album/script/upload.php?type=e";a.submit()}},delfile:function(){$.ajax({type:"POST",url:"/include/plugins/jquery.php?app=album,data&sess=true&func=del&args[]="+$("#fileID").val(),data:{},success:function(a){eval(a);$("#fileID").val("");
$("#filePathInfo").val("");0==res[0]&&this.notice(0)}})},notice:function(a){$("#uploading").css("display","none");$("#picture").val("");$("#select").css("display","block");var b="";0==a&&(b="\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u60a8\u5fc5\u987b\u662f\u767b\u5f55\u72b6\u6001!\n\u60a8\u7684\u5f53\u524d\u7684\u72b6\u6001\u662f\u6ca1\u6709\u767b\u5f55\u6216\u767b\u5f55\u65f6\u95f4\u5df2\u7ecf\u8d85\u65f6,\u8bf7\u91cd\u65b0\u767b\u5f55!");1==a&&(b="\u5f88\u62b1\u6b49, \u76ee\u524d\u6211\u4eec\u7684\u7cfb\u7edf\u4e0d\u652f\u6301\u60a8\u4e0a\u4f20\u7684\u56fe\u7247\u683c\u5f0f!");
2==a&&(b="\u670d\u52a1\u5668\u9519\u8bef\uff0c\u4e0a\u4f20\u6587\u4ef6\u8fc7\u5927!");3==a&&(b="\u670d\u52a1\u5668\u9519\u8bef\uff0c\u4e0a\u4f20\u6587\u4ef6\u4e0d\u5408\u6cd5!");500==a&&(b="\u670d\u52a1\u5668\u53d1\u751f\u9519\u8bef\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb!");alert(b)},fileCheck:function(){var a=this.fileExt($("#picture").val());return-1=="JPG, JPEG, PNG, GIF".indexOf(a.toUpperCase())?(this.fileMsg(a,"jpg, jpeg, png, gif"),!1):!0},fileExt:function(a){fileName=-1<a.indexOf("/")?
a.substring(a.lastIndexOf("/")+1,a.length):a.substring(a.lastIndexOf("\\")+1,a.length);return fileName.substring(fileName.lastIndexOf(".")+1,fileName.length)},fileMsg:function(a,b){$("#uploading").css("display","none");$("#picture").val("");$("#select").css("display","block");alert('\u5f53\u524d\u6587\u4ef6\u7c7b\u578b: "'+a+'" \u4e0d\u5141\u8bb8\u4e0a\u4f20!\n\u53ea\u6709\u4ee5\u4e0b\u7c7b\u578b\u7684\u6587\u4ef6\u624d\u88ab\u5141\u8bb8\u4e0a\u4f20: '+b+"\n\u8bf7\u91cd\u65b0\u9009\u62e9\u6587\u4ef6\u4e0a\u4f20.")},
GetConf:function(a){var b=this.getEditorDoc();return b.document.getElementById(b.editor.Instance.Name+"___"+a).value}},videoCore={type:"panel",getEditorDoc:function(){return"panel"==this.type?parent:parent.parent},preview:function(){var a=this.getEmbedCode($("#video-url").val());a&&(document.getElementById("video-ifr").src=a)},setHtml:function(){var a,b,c;if(c=this.getEmbedCode($("#video-url").val())){""==$("#video-w").val()?a=420:(a=parseInt($("#video-w").val()),0==a&&(a=420));""==$("#video-h").val()?
b=360:(b=parseInt($("#video-h").val()),0==b&&(b=360));this.cancel();var d=this.getEditorDoc();d.editor.Instance.InsertHtml('<iframe width="'+a+'" height="'+b+'" src="'+c+'" frameborder="0" style="z-index:0;" scrolling="no" allowfullscreen></iframe>');a=d.editor.Instance.GetHTML(!0);d.editor.Instance.SetHTML(a);"panel"!=this.type&&parent.Cancel()}},getEmbedCode:function(a){var b="";if(""==a)return alert("\u8bf7\u8f93\u5165\u8981\u5206\u4eab\u7684\u89c6\u9891\u5730\u5740"),$("#video-url").focus(),!1;
if(-1!=a.indexOf("http://www.youtube.com/")&&(-1!=a.indexOf("?v=")||-1!=a.indexOf("&v="))){b=0;-1!=a.indexOf("?v=")&&(b=a.indexOf("?v=")+3);-1!=a.indexOf("&v=")&&(b=a.indexOf("&v=")+3);var c=a.indexOf("&",b),d="",d=-1!=c?a.substring(b,c):a.substring(b),b="http://www.youtube.com/embed/"+d+"?rel=0"}-1!=a.indexOf("http://youtu.be/")&&(b=a.replace("youtu.be/","www.youtube.com/embed/")+"?rel=0");return""==b?(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u89c6\u9891\u5206\u4eab\u5730\u5740, \n\u60a8\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528YouTube\u7684\u5206\u4eab\u4ee3\u7801\u6216\u89c6\u9891\u7684URL\u5730\u5740,\u5f53\u505a\u6b64\u5904\u7684\u89c6\u9891\u5206\u4eab\u5730\u5740\n\u672c\u7ad9\u76ee\u524d\u4ec5\u652f\u6301YouTube\u89c6\u9891\u5206\u4eab, \u5982\u6709\u4e0d\u4fbf, \u656c\u4e3b\u8c05\u89e3"),
$("#video-url").focus(),$("#video-url").select(),!1):b+"&wmode=transparent"},cancel:function(){"panel"==this.type&&(this.setPanelClose(),parent.editor.Instance.Focus(),parent.editor.Instance.Events.FireEvent("OnSelectionChange"))},setPanelClose:function(){$("#video-w").val("420");$("#video-h").val("360");$("#video-url").val("");document.getElementById("video-ifr").src="/include/editor/api/html/Video.html";parent.document.getElementById(parent.editor.Instance.Name+"___PanelStatus").value=0}},mediaCore=
{type:"panel",g:function(a){return document.getElementById(a)},getEditorDoc:function(){return"panel"==this.type?parent:parent.parent},init:function(){$("#dataID").val(this.GetConf("dataID"));$("#dataType").val(this.GetConf("dataType"));$("#TempID").val(this.GetConf("TempID"))},showDemo:function(a,b,c,d,e){$("#userID").val(a);$("#NickName").val(b);$("#fileID").val(d);$("#filePathInfo").val(e);d=this.getEditorDoc();var f=d.editor.Instance.Name+"___TempID";""==d.document.getElementById(f).value&&(d.document.getElementById(f).value=
c);$("#uploading").css("display","none");$("#music").val("");$("#select").css("display","block");$("#confirm").css("display","block");this.g("music-ifr").src="/include/editor/api/script/audio.php?uid="+a+"&username="+b+"&url="+e},setHtml:function(){var a=$("#userID").val(),b=$("#NickName").val(),c=$("#filePathInfo").val();$("#fileID").val("");$("#filePathInfo").val("");var d=this.g("autostart").checked?"yes":"no";this.cancel();var e=this.getEditorDoc();e.editor.Instance.InsertHtml('<iframe width="320" height="24" src="/include/editor/api/script/audio.php?uid='+
a+"&username="+b+"&url="+c+"&autostart="+d+'" scrolling="no" frameborder="0"></iframe>');a=e.editor.Instance.GetHTML(!0);e.editor.Instance.SetHTML(a);"panel"!=this.type&&parent.Cancel()},cancel:function(){$("#uploading").css("display","none");$("#music").val("");$("#select").css("display","block");$("#confirm").css("display","none");this.g("music-ifr").src="/include/editor/api/script/audio.php";""!=$("#fileID").val()&&this.delfile();"panel"==this.type&&(this.setPanelClose(),parent.editor.Instance.Focus(),
parent.editor.Instance.Events.FireEvent("OnSelectionChange"))},setPanelClose:function(){parent.document.getElementById(parent.editor.Instance.Name+"___PanelStatus").value=0},addfile:function(){$("#uploading").css("display","block");$("#select").css("display","none");if(this.fileCheck()){var a=this.g("music_upload_input");a.action="/media/script/upload.php?type=e";a.submit()}else this.notice(1)},delfile:function(){$.ajax({type:"POST",url:"/include/plugins/jquery.php?app=media,data&sess=true&func=del&args[]="+
$("#fileID").val(),data:{},success:function(a){eval(a);$("#fileID").val("");$("#filePathInfo").val("");0==res[0]&&mediaCore.notice(0)}})},notice:function(a){$("#uploading").css("display","none");$("#music").val("");$("#select").css("display","block");var b="";0==a&&(b="\u4e0a\u4f20\u6587\u4ef6\u65f6,\u60a8\u5fc5\u987b\u662f\u767b\u5f55\u72b6\u6001!\n\u60a8\u7684\u5f53\u524d\u7684\u72b6\u6001\u662f\u6ca1\u6709\u767b\u5f55\u6216\u767b\u5f55\u65f6\u95f4\u5df2\u7ecf\u8d85\u65f6, \u8bf7\u91cd\u65b0\u767b\u5f55!");
1==a&&(b="\u5f88\u62b1\u6b49,\u76ee\u524d\u6211\u4eec\u7684\u7cfb\u7edf\u4ec5\u652f\u6301mp3\u683c\u5f0f\u7684\u97f3\u9891\u6587\u4ef6!");2==a&&(b="\u670d\u52a1\u5668\u9519\u8bef, \u4e0a\u4f20\u6587\u4ef6\u8fc7\u5927!");3==a&&(b="\u670d\u52a1\u5668\u9519\u8bef, \u4e0a\u4f20\u6587\u4ef6\u4e0d\u5408\u6cd5!");500==a&&(b="\u670d\u52a1\u5668\u53d1\u751f\u9519\u8bef, \u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb!");alert(b)},fileCheck:function(){var a=this.fileExt($("#music").val());return-1=="MP3".indexOf(a.toUpperCase())?
!1:!0},fileExt:function(a){fileName=-1<a.indexOf("/")?a.substring(a.lastIndexOf("/")+1,a.length):a.substring(a.lastIndexOf("\\")+1,a.length);return fileName.substring(fileName.lastIndexOf(".")+1,fileName.length)},GetConf:function(a){var b=this.getEditorDoc();return b.document.getElementById(b.editor.Instance.Name+"___"+a).value}};
