'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setCurrentReadtable = setCurrentReadtable;
exports.getCurrentReadtable = getCurrentReadtable;

var _charStream = require('./char-stream');

let currentReadtable;

class Reader {
  read(stream, ...rest) {
    let char = stream.peek();
    if (!(0, _charStream.isEOS)(char)) {
      const entry = currentReadtable.getEntry(char);
      const result = entry.action.call(this, stream, ...rest);
      return result;
    }
    throw Error('Unexpected end of input');
  }
}

exports.default = Reader;
function setCurrentReadtable(readtable) {
  currentReadtable = readtable;
}

function getCurrentReadtable() {
  return currentReadtable;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yZWFkZXIvcmVhZGVyLmpzIl0sIm5hbWVzIjpbInNldEN1cnJlbnRSZWFkdGFibGUiLCJnZXRDdXJyZW50UmVhZHRhYmxlIiwiY3VycmVudFJlYWR0YWJsZSIsIlJlYWRlciIsInJlYWQiLCJzdHJlYW0iLCJyZXN0IiwiY2hhciIsInBlZWsiLCJlbnRyeSIsImdldEVudHJ5IiwicmVzdWx0IiwiYWN0aW9uIiwiY2FsbCIsIkVycm9yIiwicmVhZHRhYmxlIl0sIm1hcHBpbmdzIjoiOzs7OztRQXFCZ0JBLG1CLEdBQUFBLG1CO1FBSUFDLG1CLEdBQUFBLG1COztBQXBCaEI7O0FBRUEsSUFBSUMsZ0JBQUo7O0FBRWUsTUFBTUMsTUFBTixDQUFhO0FBQzFCQyxPQUFLQyxNQUFMLEVBQXlCLEdBQUdDLElBQTVCLEVBQW9EO0FBQ2xELFFBQUlDLE9BQU9GLE9BQU9HLElBQVAsRUFBWDtBQUNBLFFBQUksQ0FBQyx1QkFBTUQsSUFBTixDQUFMLEVBQWtCO0FBQ2hCLFlBQU1FLFFBQVFQLGlCQUFpQlEsUUFBakIsQ0FBMEJILElBQTFCLENBQWQ7QUFDQSxZQUFNSSxTQUFTRixNQUFNRyxNQUFOLENBQWFDLElBQWIsQ0FBa0IsSUFBbEIsRUFBd0JSLE1BQXhCLEVBQWdDLEdBQUdDLElBQW5DLENBQWY7QUFDQSxhQUFPSyxNQUFQO0FBQ0Q7QUFDRCxVQUFNRyxNQUFNLHlCQUFOLENBQU47QUFDRDtBQVR5Qjs7a0JBQVBYLE07QUFZZCxTQUFTSCxtQkFBVCxDQUE2QmUsU0FBN0IsRUFBeUQ7QUFDOURiLHFCQUFtQmEsU0FBbkI7QUFDRDs7QUFFTSxTQUFTZCxtQkFBVCxHQUEwQztBQUMvQyxTQUFPQyxnQkFBUDtBQUNEIiwiZmlsZSI6InJlYWRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XG5cbmltcG9ydCB0eXBlIFJlYWR0YWJsZSBmcm9tICcuL3JlYWR0YWJsZSc7XG5pbXBvcnQgdHlwZSBDaGFyU3RyZWFtIGZyb20gJy4vY2hhci1zdHJlYW0nO1xuXG5pbXBvcnQgeyBpc0VPUyB9IGZyb20gJy4vY2hhci1zdHJlYW0nO1xuXG5sZXQgY3VycmVudFJlYWR0YWJsZTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVhZGVyIHtcbiAgcmVhZChzdHJlYW06IENoYXJTdHJlYW0sIC4uLnJlc3Q/OiBBcnJheTxhbnk+KTogYW55IHtcbiAgICBsZXQgY2hhciA9IHN0cmVhbS5wZWVrKCk7XG4gICAgaWYgKCFpc0VPUyhjaGFyKSkge1xuICAgICAgY29uc3QgZW50cnkgPSBjdXJyZW50UmVhZHRhYmxlLmdldEVudHJ5KGNoYXIpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gZW50cnkuYWN0aW9uLmNhbGwodGhpcywgc3RyZWFtLCAuLi5yZXN0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRocm93IEVycm9yKCdVbmV4cGVjdGVkIGVuZCBvZiBpbnB1dCcpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRDdXJyZW50UmVhZHRhYmxlKHJlYWR0YWJsZTogUmVhZHRhYmxlKTogdm9pZCB7XG4gIGN1cnJlbnRSZWFkdGFibGUgPSByZWFkdGFibGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50UmVhZHRhYmxlKCk6IFJlYWR0YWJsZSB7XG4gIHJldHVybiBjdXJyZW50UmVhZHRhYmxlO1xufVxuIl19