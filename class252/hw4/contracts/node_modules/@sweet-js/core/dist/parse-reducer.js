"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _terms = require("./terms");

var _terms2 = _interopRequireDefault(_terms);

var _shiftReducer = require("shift-reducer");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class ParseReducer extends _shiftReducer.CloneReducer {
  constructor(context) {
    super();
    this.context = context;
  }
  reduceModule(node, state) {
    return new _terms2.default("Module", {
      directives: state.directives.toArray(),
      items: state.items.toArray()
    });
  }

  reduceImport(node, state) {
    let moduleSpecifier = state.moduleSpecifier ? state.moduleSpecifier.val() : null;
    return new _terms2.default('Import', {
      defaultBinding: state.defaultBinding,
      namedImports: state.namedImports.toArray(),
      moduleSpecifier: moduleSpecifier,
      forSyntax: node.forSyntax
    });
  }

  reduceImportNamespace(node, state) {
    let moduleSpecifier = state.moduleSpecifier ? state.moduleSpecifier.val() : null;
    return new _terms2.default('ImportNamespace', {
      defaultBinding: state.defaultBinding,
      namespaceBinding: state.namespaceBinding,
      moduleSpecifier: moduleSpecifier,
      forSyntax: node.forSyntax
    });
  }

  reduceExport(node, state) {
    return new _terms2.default('Export', {
      declaration: state.declaration
    });
  }

  reduceExportAllFrom(node, state) {
    let moduleSpecifier = state.moduleSpecifier ? state.moduleSpecifier.val() : null;
    return new _terms2.default('ExportAllFrom', { moduleSpecifier: moduleSpecifier });
  }

  reduceExportFrom(node, state) {
    let moduleSpecifier = state.moduleSpecifier ? state.moduleSpecifier.val() : null;
    return new _terms2.default('ExportFrom', {
      moduleSpecifier: moduleSpecifier,
      namedExports: state.namedExports.toArray()
    });
  }

  reduceExportSpecifier(node, state) {
    let name = state.name,
        exportedName = state.exportedName;
    if (name == null) {
      name = exportedName.resolve(this.context.phase);
      exportedName = exportedName.val();
    } else {
      name = name.resolve(this.context.phase);
      exportedName = exportedName.val();
    }
    return new _terms2.default('ExportSpecifier', {
      name: name, exportedName: exportedName
    });
  }

  reduceImportSpecifier(node, state) {
    let name = state.name ? state.name.resolve(this.context.phase) : null;
    return new _terms2.default('ImportSpecifier', {
      name: name,
      binding: state.binding
    });
  }

  reduceIdentifierExpression(node) {
    return new _terms2.default("IdentifierExpression", {
      name: node.name.resolve(this.context.phase)
    });
  }

  reduceLiteralNumericExpression(node) {
    return new _terms2.default("LiteralNumericExpression", {
      value: node.value.val()
    });
  }

  reduceLiteralBooleanExpression(node) {
    return new _terms2.default("LiteralBooleanExpression", {
      value: node.value.val() === 'true'
    });
  }

  reduceLiteralStringExpression(node) {
    return new _terms2.default("LiteralStringExpression", {
      value: node.value.token.str
    });
  }

  reduceCallExpression(node, state) {
    return new _terms2.default("CallExpression", {
      callee: state.callee,
      arguments: state.arguments.toArray()
    });
  }

  reduceFunctionBody(node, state) {
    return new _terms2.default("FunctionBody", {
      directives: state.directives.toArray(),
      statements: state.statements.toArray()
    });
  }

  reduceBlock(node, state) {
    return new _terms2.default("Block", {
      statements: state.statements.toArray()
    });
  }

  reduceFormalParameters(node, state) {
    return new _terms2.default("FormalParameters", {
      items: state.items.toArray(),
      rest: state.rest
    });
  }

  reduceBindingIdentifier(node) {
    return new _terms2.default("BindingIdentifier", {
      name: node.name.resolve(this.context.phase)
    });
  }

  reduceBinaryExpression(node, state) {
    return new _terms2.default("BinaryExpression", {
      left: state.left,
      operator: node.operator.val(),
      right: state.right
    });
  }

  reduceObjectExpression(node, state) {
    return new _terms2.default("ObjectExpression", {
      properties: state.properties.toArray()
    });
  }

  reduceVariableDeclaration(node, state) {
    return new _terms2.default("VariableDeclaration", {
      kind: state.kind,
      declarators: state.declarators.toArray()
    });
  }

  reduceStaticPropertyName(node) {
    return new _terms2.default("StaticPropertyName", {
      value: node.value.val().toString()
    });
  }

  reduceArrayExpression(node, state) {
    return new _terms2.default("ArrayExpression", {
      elements: state.elements.toArray()
    });
  }

  reduceStaticMemberExpression(node, state) {
    return new _terms2.default("StaticMemberExpression", {
      object: state.object,
      property: state.property.val()
    });
  }

}
exports.default = ParseReducer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXJzZS1yZWR1Y2VyLmpzIl0sIm5hbWVzIjpbIlBhcnNlUmVkdWNlciIsImNvbnN0cnVjdG9yIiwiY29udGV4dCIsInJlZHVjZU1vZHVsZSIsIm5vZGUiLCJzdGF0ZSIsImRpcmVjdGl2ZXMiLCJ0b0FycmF5IiwiaXRlbXMiLCJyZWR1Y2VJbXBvcnQiLCJtb2R1bGVTcGVjaWZpZXIiLCJ2YWwiLCJkZWZhdWx0QmluZGluZyIsIm5hbWVkSW1wb3J0cyIsImZvclN5bnRheCIsInJlZHVjZUltcG9ydE5hbWVzcGFjZSIsIm5hbWVzcGFjZUJpbmRpbmciLCJyZWR1Y2VFeHBvcnQiLCJkZWNsYXJhdGlvbiIsInJlZHVjZUV4cG9ydEFsbEZyb20iLCJyZWR1Y2VFeHBvcnRGcm9tIiwibmFtZWRFeHBvcnRzIiwicmVkdWNlRXhwb3J0U3BlY2lmaWVyIiwibmFtZSIsImV4cG9ydGVkTmFtZSIsInJlc29sdmUiLCJwaGFzZSIsInJlZHVjZUltcG9ydFNwZWNpZmllciIsImJpbmRpbmciLCJyZWR1Y2VJZGVudGlmaWVyRXhwcmVzc2lvbiIsInJlZHVjZUxpdGVyYWxOdW1lcmljRXhwcmVzc2lvbiIsInZhbHVlIiwicmVkdWNlTGl0ZXJhbEJvb2xlYW5FeHByZXNzaW9uIiwicmVkdWNlTGl0ZXJhbFN0cmluZ0V4cHJlc3Npb24iLCJ0b2tlbiIsInN0ciIsInJlZHVjZUNhbGxFeHByZXNzaW9uIiwiY2FsbGVlIiwiYXJndW1lbnRzIiwicmVkdWNlRnVuY3Rpb25Cb2R5Iiwic3RhdGVtZW50cyIsInJlZHVjZUJsb2NrIiwicmVkdWNlRm9ybWFsUGFyYW1ldGVycyIsInJlc3QiLCJyZWR1Y2VCaW5kaW5nSWRlbnRpZmllciIsInJlZHVjZUJpbmFyeUV4cHJlc3Npb24iLCJsZWZ0Iiwib3BlcmF0b3IiLCJyaWdodCIsInJlZHVjZU9iamVjdEV4cHJlc3Npb24iLCJwcm9wZXJ0aWVzIiwicmVkdWNlVmFyaWFibGVEZWNsYXJhdGlvbiIsImtpbmQiLCJkZWNsYXJhdG9ycyIsInJlZHVjZVN0YXRpY1Byb3BlcnR5TmFtZSIsInRvU3RyaW5nIiwicmVkdWNlQXJyYXlFeHByZXNzaW9uIiwiZWxlbWVudHMiLCJyZWR1Y2VTdGF0aWNNZW1iZXJFeHByZXNzaW9uIiwib2JqZWN0IiwicHJvcGVydHkiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFFZSxNQUFNQSxZQUFOLG9DQUF3QztBQUNyREMsY0FBWUMsT0FBWixFQUFxQjtBQUNuQjtBQUNBLFNBQUtBLE9BQUwsR0FBZUEsT0FBZjtBQUNEO0FBQ0RDLGVBQWFDLElBQWIsRUFBbUJDLEtBQW5CLEVBQTBCO0FBQ3hCLFdBQU8sb0JBQVMsUUFBVCxFQUFtQjtBQUN4QkMsa0JBQVlELE1BQU1DLFVBQU4sQ0FBaUJDLE9BQWpCLEVBRFk7QUFFeEJDLGFBQU9ILE1BQU1HLEtBQU4sQ0FBWUQsT0FBWjtBQUZpQixLQUFuQixDQUFQO0FBSUQ7O0FBRURFLGVBQWFMLElBQWIsRUFBbUJDLEtBQW5CLEVBQTBCO0FBQ3hCLFFBQUlLLGtCQUFrQkwsTUFBTUssZUFBTixHQUF3QkwsTUFBTUssZUFBTixDQUFzQkMsR0FBdEIsRUFBeEIsR0FBc0QsSUFBNUU7QUFDQSxXQUFPLG9CQUFTLFFBQVQsRUFBbUI7QUFDeEJDLHNCQUFnQlAsTUFBTU8sY0FERTtBQUV4QkMsb0JBQWNSLE1BQU1RLFlBQU4sQ0FBbUJOLE9BQW5CLEVBRlU7QUFHeEJHLHNDQUh3QjtBQUl4QkksaUJBQVdWLEtBQUtVO0FBSlEsS0FBbkIsQ0FBUDtBQU1EOztBQUVEQyx3QkFBc0JYLElBQXRCLEVBQTRCQyxLQUE1QixFQUFtQztBQUNqQyxRQUFJSyxrQkFBa0JMLE1BQU1LLGVBQU4sR0FBd0JMLE1BQU1LLGVBQU4sQ0FBc0JDLEdBQXRCLEVBQXhCLEdBQXNELElBQTVFO0FBQ0EsV0FBTyxvQkFBUyxpQkFBVCxFQUE0QjtBQUNqQ0Msc0JBQWdCUCxNQUFNTyxjQURXO0FBRWpDSSx3QkFBa0JYLE1BQU1XLGdCQUZTO0FBR2pDTixzQ0FIaUM7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QUNsQyxXQUFPLG9CQUFTLGtCQUFULEVBQTZCO0FBQ2xDNkMsa0JBQVk3QyxNQUFNNkMsVUFBTixDQUFpQjNDLE9BQWpCO0FBRHNCLEtBQTdCLENBQVA7QUFHRDs7QUFFRDRDLDRCQUEwQi9DLElBQTFCLEVBQWdDQyxLQUFoQyxFQUF1QztBQUNyQyxXQUFPLG9CQUFTLHFCQUFULEVBQWdDO0FBQ3JDK0MsWUFBTS9DLE1BQU0rQyxJQUR5QjtBQUVyQ0MsbUJBQWFoRCxNQUFNZ0QsV0FBTixDQUFrQjlDLE9BQWxCO0FBRndCLEtBQWhDLENBQVA7QUFJRDs7QUFFRCtDLDJCQUF5QmxELElBQXpCLEVBQStCO0FBQzdCLFdBQU8sb0JBQVMsb0JBQVQsRUFBK0I7QUFDcEMyQixhQUFPM0IsS0FBSzJCLEtBQUwsQ0FBV3BCLEdBQVgsR0FBaUI0QyxRQUFqQjtBQUQ2QixLQUEvQixDQUFQO0FBR0Q7O0FBRURDLHdCQUFzQnBELElBQXRCLEVBQTRCQyxLQUE1QixFQUFtQztBQUNqQyxXQUFPLG9CQUFTLGlCQUFULEVBQTRCO0FBQ2pDb0QsZ0JBQVVwRCxNQUFNb0QsUUFBTixDQUFlbEQsT0FBZjtBQUR1QixLQUE1QixDQUFQO0FBR0Q7O0FBRURtRCwrQkFBNkJ0RCxJQUE3QixFQUFtQ0MsS0FBbkMsRUFBMEM7QUFDeEMsV0FBTyxvQkFBUyx3QkFBVCxFQUFtQztBQUN4Q3NELGNBQVF0RCxNQUFNc0QsTUFEMEI7QUFFeENDLGdCQUFVdkQsTUFBTXVELFFBQU4sQ0FBZWpELEdBQWY7QUFGOEIsS0FBbkMsQ0FBUDtBQUlEOztBQXhLb0Q7a0JBQWxDWCxZIiwiZmlsZSI6InBhcnNlLXJlZHVjZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGVybSBmcm9tIFwiLi90ZXJtc1wiO1xuaW1wb3J0IHsgQ2xvbmVSZWR1Y2VyIH0gZnJvbSBcInNoaWZ0LXJlZHVjZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFyc2VSZWR1Y2VyIGV4dGVuZHMgQ2xvbmVSZWR1Y2VyIHtcbiAgY29uc3RydWN0b3IoY29udGV4dCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgfVxuICByZWR1Y2VNb2R1bGUobm9kZSwgc3RhdGUpIHtcbiAgICByZXR1cm4gbmV3IFRlcm0oXCJNb2R1bGVcIiwge1xuICAgICAgZGlyZWN0aXZlczogc3RhdGUuZGlyZWN0aXZlcy50b0FycmF5KCksXG4gICAgICBpdGVtczogc3RhdGUuaXRlbXMudG9BcnJheSgpXG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VJbXBvcnQobm9kZSwgc3RhdGUpIHtcbiAgICBsZXQgbW9kdWxlU3BlY2lmaWVyID0gc3RhdGUubW9kdWxlU3BlY2lmaWVyID8gc3RhdGUubW9kdWxlU3BlY2lmaWVyLnZhbCgpIDogbnVsbDtcbiAgICByZXR1cm4gbmV3IFRlcm0oJ0ltcG9ydCcsIHtcbiAgICAgIGRlZmF1bHRCaW5kaW5nOiBzdGF0ZS5kZWZhdWx0QmluZGluZyxcbiAgICAgIG5hbWVkSW1wb3J0czogc3RhdGUubmFtZWRJbXBvcnRzLnRvQXJyYXkoKSxcbiAgICAgIG1vZHVsZVNwZWNpZmllcixcbiAgICAgIGZvclN5bnRheDogbm9kZS5mb3JTeW50YXhcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUltcG9ydE5hbWVzcGFjZShub2RlLCBzdGF0ZSkge1xuICAgIGxldCBtb2R1bGVTcGVjaWZpZXIgPSBzdGF0ZS5tb2R1bGVTcGVjaWZpZXIgPyBzdGF0ZS5tb2R1bGVTcGVjaWZpZXIudmFsKCkgOiBudWxsO1xuICAgIHJldHVybiBuZXcgVGVybSgnSW1wb3J0TmFtZXNwYWNlJywge1xuICAgICAgZGVmYXVsdEJpbmRpbmc6IHN0YXRlLmRlZmF1bHRCaW5kaW5nLFxuICAgICAgbmFtZXNwYWNlQmluZGluZzogc3RhdGUubmFtZXNwYWNlQmluZGluZyxcbiAgICAgIG1vZHVsZVNwZWNpZmllcixcbiAgICAgIGZvclN5bnRheDogbm9kZS5mb3JTeW50YXhcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUV4cG9ydChub2RlLCBzdGF0ZSkge1xuICAgIHJldHVybiBuZXcgVGVybSgnRXhwb3J0Jywge1xuICAgICAgZGVjbGFyYXRpb246IHN0YXRlLmRlY2xhcmF0aW9uXG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VFeHBvcnRBbGxGcm9tKG5vZGUsIHN0YXRlKSB7XG4gICAgbGV0IG1vZHVsZVNwZWNpZmllciA9IHN0YXRlLm1vZHVsZVNwZWNpZmllciA/IHN0YXRlLm1vZHVsZVNwZWNpZmllci52YWwoKSA6IG51bGw7XG4gICAgcmV0dXJuIG5ldyBUZXJtKCdFeHBvcnRBbGxGcm9tJywgeyBtb2R1bGVTcGVjaWZpZXIgfSk7XG4gIH1cblxuICByZWR1Y2VFeHBvcnRGcm9tKG5vZGUsIHN0YXRlKSB7XG4gICAgbGV0IG1vZHVsZVNwZWNpZmllciA9IHN0YXRlLm1vZHVsZVNwZWNpZmllciA/IHN0YXRlLm1vZHVsZVNwZWNpZmllci52YWwoKSA6IG51bGw7XG4gICAgcmV0dXJuIG5ldyBUZXJtKCdFeHBvcnRGcm9tJywge1xuICAgICAgbW9kdWxlU3BlY2lmaWVyLFxuICAgICAgbmFtZWRFeHBvcnRzOiBzdGF0ZS5uYW1lZEV4cG9ydHMudG9BcnJheSgpXG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VFeHBvcnRTcGVjaWZpZXIobm9kZSwgc3RhdGUpIHtcbiAgICBsZXQgbmFtZSA9IHN0YXRlLm5hbWUsIGV4cG9ydGVkTmFtZSA9IHN0YXRlLmV4cG9ydGVkTmFtZTtcbiAgICBpZiAobmFtZSA9PSBudWxsKSB7XG4gICAgICBuYW1lID0gZXhwb3J0ZWROYW1lLnJlc29sdmUodGhpcy5jb250ZXh0LnBoYXNlKTtcbiAgICAgIGV4cG9ydGVkTmFtZSA9IGV4cG9ydGVkTmFtZS52YWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmFtZSA9IG5hbWUucmVzb2x2ZSh0aGlzLmNvbnRleHQucGhhc2UpO1xuICAgICAgZXhwb3J0ZWROYW1lID0gZXhwb3J0ZWROYW1lLnZhbCgpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFRlcm0oJ0V4cG9ydFNwZWNpZmllcicsIHtcbiAgICAgIG5hbWUsIGV4cG9ydGVkTmFtZVxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlSW1wb3J0U3BlY2lmaWVyKG5vZGUsIHN0YXRlKSB7XG4gICAgbGV0IG5hbWUgPSBzdGF0ZS5uYW1lID8gc3RhdGUubmFtZS5yZXNvbHZlKHRoaXMuY29udGV4dC5waGFzZSkgOiBudWxsO1xuICAgIHJldHVybiBuZXcgVGVybSgnSW1wb3J0U3BlY2lmaWVyJywge1xuICAgICAgbmFtZSxcbiAgICAgIGJpbmRpbmc6IHN0YXRlLmJpbmRpbmdcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUlkZW50aWZpZXJFeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gbmV3IFRlcm0oXCJJZGVudGlmaWVyRXhwcmVzc2lvblwiLCB7XG4gICAgICBuYW1lOiBub2RlLm5hbWUucmVzb2x2ZSh0aGlzLmNvbnRleHQucGhhc2UpXG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VMaXRlcmFsTnVtZXJpY0V4cHJlc3Npb24obm9kZSkge1xuICAgIHJldHVybiBuZXcgVGVybShcIkxpdGVyYWxOdW1lcmljRXhwcmVzc2lvblwiLCB7XG4gICAgICB2YWx1ZTogbm9kZS52YWx1ZS52YWwoKVxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlTGl0ZXJhbEJvb2xlYW5FeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gbmV3IFRlcm0oXCJMaXRlcmFsQm9vbGVhbkV4cHJlc3Npb25cIiwge1xuICAgICAgdmFsdWU6IG5vZGUudmFsdWUudmFsKCkgPT09ICd0cnVlJ1xuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlTGl0ZXJhbFN0cmluZ0V4cHJlc3Npb24obm9kZSkge1xuICAgIHJldHVybiBuZXcgVGVybShcIkxpdGVyYWxTdHJpbmdFeHByZXNzaW9uXCIsIHtcbiAgICAgIHZhbHVlOiBub2RlLnZhbHVlLnRva2VuLnN0clxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlQ2FsbEV4cHJlc3Npb24obm9kZSwgc3RhdGUpIHtcbiAgICByZXR1cm4gbmV3IFRlcm0oXCJDYWxsRXhwcmVzc2lvblwiLCB7XG4gICAgICBjYWxsZWU6IHN0YXRlLmNhbGxlZSxcbiAgICAgIGFyZ3VtZW50czogc3RhdGUuYXJndW1lbnRzLnRvQXJyYXkoKVxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlRnVuY3Rpb25Cb2R5KG5vZGUsIHN0YXRlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiRnVuY3Rpb25Cb2R5XCIsIHtcbiAgICAgIGRpcmVjdGl2ZXM6IHN0YXRlLmRpcmVjdGl2ZXMudG9BcnJheSgpLFxuICAgICAgc3RhdGVtZW50czogc3RhdGUuc3RhdGVtZW50cy50b0FycmF5KClcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUJsb2NrKG5vZGUsIHN0YXRlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiQmxvY2tcIiwge1xuICAgICAgc3RhdGVtZW50czogc3RhdGUuc3RhdGVtZW50cy50b0FycmF5KClcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUZvcm1hbFBhcmFtZXRlcnMobm9kZSwgc3RhdGUpIHtcbiAgICByZXR1cm4gbmV3IFRlcm0oXCJGb3JtYWxQYXJhbWV0ZXJzXCIsIHtcbiAgICAgIGl0ZW1zOiBzdGF0ZS5pdGVtcy50b0FycmF5KCksXG4gICAgICByZXN0OiBzdGF0ZS5yZXN0XG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VCaW5kaW5nSWRlbnRpZmllcihub2RlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiQmluZGluZ0lkZW50aWZpZXJcIiwge1xuICAgICAgbmFtZTogbm9kZS5uYW1lLnJlc29sdmUodGhpcy5jb250ZXh0LnBoYXNlKVxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlQmluYXJ5RXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuICAgIHJldHVybiBuZXcgVGVybShcIkJpbmFyeUV4cHJlc3Npb25cIiwge1xuICAgICAgbGVmdDogc3RhdGUubGVmdCxcbiAgICAgIG9wZXJhdG9yOiBub2RlLm9wZXJhdG9yLnZhbCgpLFxuICAgICAgcmlnaHQ6IHN0YXRlLnJpZ2h0XG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VPYmplY3RFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiT2JqZWN0RXhwcmVzc2lvblwiLCB7XG4gICAgICBwcm9wZXJ0aWVzOiBzdGF0ZS5wcm9wZXJ0aWVzLnRvQXJyYXkoKVxuICAgIH0pO1xuICB9XG5cbiAgcmVkdWNlVmFyaWFibGVEZWNsYXJhdGlvbihub2RlLCBzdGF0ZSkge1xuICAgIHJldHVybiBuZXcgVGVybShcIlZhcmlhYmxlRGVjbGFyYXRpb25cIiwge1xuICAgICAga2luZDogc3RhdGUua2luZCxcbiAgICAgIGRlY2xhcmF0b3JzOiBzdGF0ZS5kZWNsYXJhdG9ycy50b0FycmF5KClcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZVN0YXRpY1Byb3BlcnR5TmFtZShub2RlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiU3RhdGljUHJvcGVydHlOYW1lXCIsIHtcbiAgICAgIHZhbHVlOiBub2RlLnZhbHVlLnZhbCgpLnRvU3RyaW5nKClcbiAgICB9KTtcbiAgfVxuXG4gIHJlZHVjZUFycmF5RXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuICAgIHJldHVybiBuZXcgVGVybShcIkFycmF5RXhwcmVzc2lvblwiLCB7XG4gICAgICBlbGVtZW50czogc3RhdGUuZWxlbWVudHMudG9BcnJheSgpXG4gICAgfSk7XG4gIH1cblxuICByZWR1Y2VTdGF0aWNNZW1iZXJFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG4gICAgcmV0dXJuIG5ldyBUZXJtKFwiU3RhdGljTWVtYmVyRXhwcmVzc2lvblwiLCB7XG4gICAgICBvYmplY3Q6IHN0YXRlLm9iamVjdCxcbiAgICAgIHByb3BlcnR5OiBzdGF0ZS5wcm9wZXJ0eS52YWwoKVxuICAgIH0pO1xuICB9XG5cbn1cbiJdfQ==